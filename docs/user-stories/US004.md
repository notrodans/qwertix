# User Story: AFK Detection

**ID:** US004  
**Priority:** Low  
**Estimate:** Small  
**Epic:** Room Management

## Story

As a system, I want to automatically remove inactive players from lobbies so that rooms remain active and hosts don't block progress.

## Acceptance Criteria

- [ ] Users inactive for 10 minutes in the `LOBBY` state are automatically removed from the room
- [ ] If the host is removed due to inactivity, the host role is automatically transferred to the next available participant
- [ ] AFK detection does not remove players during an active race (inactive players result in DNF)
- [ ] Explicit actions (e.g., changing settings, starting race) reset the inactivity timer
- [ ] Passive heartbeats (`PONG`) do not count as activity for AFK detection
- [ ] Removed user receives a specific `AFK_TIMEOUT` disconnection reason
- [ ] Remaining users in the room see a standard `PLAYER_LEFT` event

## Notes

- Periodic check runs every 1 minute via `SocketManager`
- Helps prevent "zombie" lobbies where a host has abandoned the tab

## Tasks

- [ ] Add `lastActiveAt` timestamp tracking to `Participant` entity
- [ ] Implement periodic AFK check logic in `SocketManager`
- [ ] Handle host migration logic when the current host is removed
